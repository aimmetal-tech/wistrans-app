api.md
# API æ¥å£æ–‡æ¡£

## åŸºç¡€ä¿¡æ¯

- æœåŠ¡å™¨åœ°å€: `http://localhost:8000`
- æ•°æ®æ ¼å¼: JSON
- å­—ç¬¦ç¼–ç : UTF-8

## æ¥å£åˆ—è¡¨

### 1. ç”¨æˆ·æ³¨å†Œæ¥å£

#### æ¥å£è¯´æ˜

ç”¨äºæ–°ç”¨æˆ·æ³¨å†Œè´¦æˆ·

#### æ¥å£åœ°å€

```
POST /user/register
```

#### è¯·æ±‚å‚æ•°

| å‚æ•°å         | ç±»å‹   | å¿…å¡« | è¯´æ˜         |
| -------------- | ------ | ---- | ------------ |
| username       | string | æ˜¯   | ç”¨æˆ·å       |
| password       | string | æ˜¯   | å¯†ç          |
| confirm_password | string | æ˜¯   | ç¡®è®¤å¯†ç      |

#### è¯·æ±‚ä½“ç¤ºä¾‹

```json
{
  "username": "example_user",
  "password": "example_password",
  "confirm_password": "example_password"
}
```

#### å“åº”ç»“æœ

| å‚æ•°å   | ç±»å‹   | è¯´æ˜   |
| -------- | ------ | ------ |
| id       | int    | ç”¨æˆ·ID |
| username | string | ç”¨æˆ·å |

#### å“åº”ç¤ºä¾‹

```json
{
  "id": 1,
  "username": "example_user"
}

### 2. ç”¨æˆ·ç™»å½•æ¥å£

#### æ¥å£è¯´æ˜

ç”¨äºå·²æ³¨å†Œç”¨æˆ·ç™»å½•ç³»ç»Ÿ

#### æ¥å£åœ°å€

```
POST /user/login
```

#### è¯·æ±‚å‚æ•°

| å‚æ•°å   | ç±»å‹   | å¿…å¡« | è¯´æ˜   |
| -------- | ------ | ---- | ------ |
| username | string | æ˜¯   | ç”¨æˆ·å |
| password | string | æ˜¯   | å¯†ç    |

#### è¯·æ±‚ä½“ç¤ºä¾‹

```json
{
  "username": "example_user",
  "password": "example_password"
}
```

#### å“åº”ç»“æœ

| å‚æ•°å    | ç±»å‹   | è¯´æ˜         |
| --------- | ------ | ------------ |
| message   | string | ç™»å½•æ¶ˆæ¯     |
| user      | object | ç”¨æˆ·ä¿¡æ¯å¯¹è±¡ |

##### userå¯¹è±¡è¯´æ˜

| å‚æ•°å   | ç±»å‹   | è¯´æ˜   |
| -------- | ------ | ------ |
| id       | int    | ç”¨æˆ·ID |
| username | string | ç”¨æˆ·å |

#### å“åº”ç¤ºä¾‹

```json
{
  "message": "ç™»å½•æˆåŠŸ",
  "user": {
    "id": 1,
    "username": "example_user"
  }
}

### 3. ç½‘é¡µç¿»è¯‘æ¥å£

#### æ¥å£è¯´æ˜

ä¸“é—¨ç”¨äºç½‘é¡µå†…å®¹ç¿»è¯‘çš„æ¥å£ï¼Œæ”¯æŒæ‰¹é‡ç¿»è¯‘å¤šä¸ªæ–‡æœ¬ç‰‡æ®µ

#### æ¥å£åœ°å€

```
POST /translate
```

#### è¯·æ±‚å‚æ•°

| å‚æ•°å     | ç±»å‹   | å¿…å¡« | è¯´æ˜                             |
| ---------- | ------ | ---- | -------------------------------- |
| target     | string | æ˜¯   | ç›®æ ‡è¯­è¨€ï¼Œå¦‚ "en" è¡¨ç¤ºç¿»è¯‘ä¸ºè‹±è¯­ |
| segments   | array  | æ˜¯   | è¦ç¿»è¯‘çš„æ–‡æœ¬ç‰‡æ®µåˆ—è¡¨             |
| extra_args | object | å¦   | ç¿»è¯‘çš„é¢å¤–è¦æ±‚ï¼Œå¦‚é£æ ¼ã€èº«ä»½ç­‰   |

#### segments å‚æ•°è¯´æ˜

| å‚æ•°å | ç±»å‹   | å¿…å¡« | è¯´æ˜                                        |
| ------ | ------ | ---- | ------------------------------------------- |
| id     | string | æ˜¯   | ç‰‡æ®µ IDï¼Œç”¨äºæ ‡è¯†ç‰‡æ®µä»¥ä¾¿è¿”å›åˆ°å‰ç«¯ç›¸åº”ä½ç½® |
| text   | string | æ˜¯   | è¦ç¿»è¯‘çš„æ–‡æœ¬å†…å®¹                            |
| model  | string | å¦   | æ¨¡å‹åç§°ï¼Œé»˜è®¤ä¸º "qwen-turbo-latest"            |

#### extra_args å‚æ•°è¯´æ˜

| å‚æ•°å   | ç±»å‹   | å¿…å¡« | è¯´æ˜                                                                 |
| -------- | ------ | ---- | -------------------------------------------------------------------- |
| style    | string | å¦   | ç¿»è¯‘çš„é£æ ¼è¦æ±‚ï¼Œå¦‚"æ¯å¥å¼€å¤´åŠ ä¸Š`ğŸ˜­`ï¼Œåœ¨æ¯å¥ç¿»è¯‘ååŠ ä¸Š`ğŸ˜Š`"          |
| identity | string | å¦   | ç¿»è¯‘ä¸“å®¶çš„èº«ä»½ï¼Œå¯é€‰å€¼ï¼š"é€šç”¨ä¸“å®¶"ã€"å­¦æœ¯è®ºæ–‡ç¿»è¯‘å¸ˆ"ã€"æ„è¯‘ä½œå®¶"ã€"ç¨‹åºä¸“å®¶"ã€"å¤ä»Šä¸­å¤–ç¿»è¯‘å¸ˆ" |

#### è¯·æ±‚ä½“ç¤ºä¾‹

```json
{
  "target": "en",
  "segments": [
    {
      "id": "segment1",
      "text": "è¿™æ˜¯è¦ç¿»è¯‘çš„æ–‡æœ¬"
    },
    {
      "id": "segment2",
      "text": "è¿™æ˜¯å¦ä¸€æ®µè¦ç¿»è¯‘çš„æ–‡æœ¬"
    }
  ],
  "extra_args": {
    "style": "æ¯å¥å¼€å¤´åŠ ä¸Š`ğŸ˜­`ï¼Œåœ¨æ¯å¥ç¿»è¯‘ååŠ ä¸Š`ğŸ˜Š`",
    "identity": "æ„è¯‘ä½œå®¶"
  }
}
```

#### å“åº”ç»“æœ

```json
{
  "translated": "en",
  "segments": [
    {
      "id": "segment1",
      "text": "ğŸ˜­This is the text to be translatedğŸ˜Š"
    },
    {
      "id": "segment2",
      "text": "ğŸ˜­This is another text to be translatedğŸ˜Š"
    }
  ]
}
```

### 2. OCRæ–‡å­—è¯†åˆ«æ¥å£

#### æ¥å£è¯´æ˜

ç”¨äºè¯†åˆ«å›¾ç‰‡ä¸­çš„æ–‡å­—å†…å®¹ï¼Œæ”¯æŒå¤šè¯­è¨€æ–‡å­—è¯†åˆ«

#### æ¥å£åœ°å€

```
POST /ocr
```

#### è¯·æ±‚å‚æ•°

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
| ------ | ------ | ---- | ---- |
| image | file | æ˜¯ | å›¾ç‰‡æ–‡ä»¶ï¼Œæ”¯æŒå¸¸è§å›¾ç‰‡æ ¼å¼ï¼ˆJPGã€PNGç­‰ï¼‰ |

æ³¨æ„ï¼šè¯¥æ¥å£ä½¿ç”¨form-dataæ ¼å¼ä¸Šä¼ æ–‡ä»¶

#### è¯·æ±‚ç¤ºä¾‹

ä½¿ç”¨curlå‘½ä»¤ç¤ºä¾‹ï¼š
```bash
curl -X POST "http://localhost:8000/ocr" \
  -H "accept: application/json" \
  -H "Content-Type: multipart/form-data" \
  -F "image=@example.jpg"
```

#### å“åº”ç»“æœ

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
| ------ | ------ | ---- |
| detected_text | array | æ£€æµ‹åˆ°çš„æ–‡æœ¬åˆ—è¡¨ï¼ŒåŒ…æ‹¬æ–‡æœ¬å†…å®¹ã€ç½®ä¿¡åº¦å’Œä½ç½®ä¿¡æ¯ |
| full_text | string | å®Œæ•´çš„è¯†åˆ«æ–‡æœ¬ï¼Œæ¯è¡Œæ–‡æœ¬ä»¥æ¢è¡Œç¬¦åˆ†éš” |

##### detected_textå…ƒç´ è¯´æ˜

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
| ------ | ------ | ---- |
| text | string | è¯†åˆ«çš„æ–‡æœ¬å†…å®¹ |
| confidence | float | è¯†åˆ«ç½®ä¿¡åº¦ï¼ŒèŒƒå›´0-1ï¼Œè¶Šæ¥è¿‘1è¡¨ç¤ºç½®ä¿¡åº¦è¶Šé«˜ |
| coordinates | array | æ–‡æœ¬æ¡†åæ ‡ï¼ŒåŒ…å«å››ä¸ªç‚¹çš„åæ ‡ä¿¡æ¯ |

#### å“åº”ç¤ºä¾‹

```json
{
  "detected_text": [
    {
      "text": "ç¤ºä¾‹æ–‡æœ¬",
      "confidence": 0.9875345,
      "coordinates": [
        [10.0, 20.0],
        [100.0, 20.0],
        [100.0, 50.0],
        [10.0, 50.0]
      ]
    }
  ],
  "full_text": "ç¤ºä¾‹æ–‡æœ¬"
}
```

### 3. OCRç¿»è¯‘æ¥å£

#### æ¥å£è¯´æ˜

ç”¨äºè¯†åˆ«å›¾ç‰‡ä¸­çš„æ–‡å­—å†…å®¹å¹¶å°†å…¶ç¿»è¯‘æˆç›®æ ‡è¯­è¨€

#### æ¥å£åœ°å€

```
POST /translate/ocr
```

#### è¯·æ±‚å‚æ•°

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
| ------ | ------ | ---- | ---- |
| image | file | æ˜¯ | å›¾ç‰‡æ–‡ä»¶ï¼Œæ”¯æŒå¸¸è§å›¾ç‰‡æ ¼å¼ï¼ˆJPGã€PNGç­‰ï¼‰ |
| target | string | å¦ | ç›®æ ‡è¯­è¨€ï¼Œé»˜è®¤ä¸º"zh" |
| model | string | å¦ | æ¨¡å‹åç§°ï¼Œé»˜è®¤ä¸º"qwen-turbo-latest" |
| extra_args | object | å¦ | ç¿»è¯‘çš„é¢å¤–è¦æ±‚ï¼Œå¦‚é£æ ¼ã€èº«ä»½ç­‰ |

æ³¨æ„ï¼šè¯¥æ¥å£ä½¿ç”¨form-dataæ ¼å¼ä¸Šä¼ æ–‡ä»¶

#### extra_args å‚æ•°è¯´æ˜

| å‚æ•°å   | ç±»å‹   | å¿…å¡« | è¯´æ˜                                                                 |
| -------- | ------ | ---- | -------------------------------------------------------------------- |
| style    | string | å¦   | ç¿»è¯‘çš„é£æ ¼è¦æ±‚ï¼Œå¦‚"æ¯å¥å¼€å¤´åŠ ä¸Š`ğŸ˜­`ï¼Œåœ¨æ¯å¥ç¿»è¯‘ååŠ ä¸Š`ğŸ˜Š`"          |
| identity | string | å¦   | ç¿»è¯‘ä¸“å®¶çš„èº«ä»½ï¼Œå¯é€‰å€¼ï¼š"é€šç”¨ä¸“å®¶"ã€"å­¦æœ¯è®ºæ–‡ç¿»è¯‘å¸ˆ"ã€"æ„è¯‘ä½œå®¶"ã€"ç¨‹åºä¸“å®¶"ã€"å¤ä»Šä¸­å¤–ç¿»è¯‘å¸ˆ" |

#### è¯·æ±‚ç¤ºä¾‹

ä½¿ç”¨curlå‘½ä»¤ç¤ºä¾‹ï¼š
```bash
curl -X POST "http://localhost:8000/translate/ocr" \
  -H "accept: application/json" \
  -H "Content-Type: multipart/form-data" \
  -F "image=@example.jpg" \
  -F "target=en"
```

#### å“åº”ç»“æœ

| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
| ------ | ------ | ---- |
| translated | string | ç¿»è¯‘çš„ç›®æ ‡è¯­è¨€ |
| detected_text | array | æ£€æµ‹åˆ°çš„æ–‡æœ¬åˆ—è¡¨ï¼ŒåŒ…æ‹¬æ–‡æœ¬å†…å®¹ã€ç½®ä¿¡åº¦å’Œä½ç½®ä¿¡æ¯ |
| full_text | string | å®Œæ•´çš„è¯†åˆ«æ–‡æœ¬ï¼Œæ¯è¡Œæ–‡æœ¬ä»¥æ¢è¡Œç¬¦åˆ†éš” |
| translated_text | string | ç¿»è¯‘åçš„æ–‡æœ¬å†…å®¹ |

#### å“åº”ç¤ºä¾‹

```json
{
  "translated": "en",
  "detected_text": [
    {
      "text": "ç¤ºä¾‹æ–‡æœ¬",
      "confidence": 0.9875345,
      "coordinates": [
        [10.0, 20.0],
        [100.0, 20.0],
        [100.0, 50.0],
        [10.0, 50.0]
      ]
    }
  ],
  "full_text": "ç¤ºä¾‹æ–‡æœ¬",
  "translated_text": "Sample text"
}
```

### 4. å•è¯ç¿»è¯‘æ¥å£

#### æ¥å£è¯´æ˜

ä¸“é—¨ç”¨äºå•è¯æˆ–çŸ­è¯­ç¿»è¯‘çš„æ¥å£ï¼Œæ”¯æŒæ‰¹é‡ç¿»è¯‘å¤šä¸ªå•è¯

#### æ¥å£åœ°å€

```
POST /trans-word
```

#### è¯·æ±‚å‚æ•°

| å‚æ•°å     | ç±»å‹   | å¿…å¡« | è¯´æ˜                             |
| ---------- | ------ | ---- | -------------------------------- |
| word       | array  | æ˜¯   | è¦ç¿»è¯‘çš„å•è¯æˆ–çŸ­è¯­åˆ—è¡¨           |
| target     | string | å¦   | ç›®æ ‡è¯­è¨€ï¼Œé»˜è®¤ä¸º"ä¸­æ–‡"           |
| model      | string | å¦   | æ¨¡å‹åç§°ï¼Œé»˜è®¤ä¸º"qwen-turbo-latest" |
| extra_args | object | å¦   | ç¿»è¯‘çš„é¢å¤–è¦æ±‚ï¼Œå¦‚é£æ ¼ã€èº«ä»½ç­‰   |

#### word å‚æ•°è¯´æ˜

| å‚æ•°å | ç±»å‹   | å¿…å¡« | è¯´æ˜                                        |
| ------ | ------ | ---- | ------------------------------------------- |
| id     | string | æ˜¯   | å•è¯ IDï¼Œç”¨äºæ ‡è¯†å•è¯ä»¥ä¾¿è¿”å›åˆ°å‰ç«¯ç›¸åº”ä½ç½® |
| word   | string | æ˜¯   | è¦ç¿»è¯‘çš„å•è¯æˆ–çŸ­è¯­å†…å®¹                      |

#### extra_args å‚æ•°è¯´æ˜

| å‚æ•°å   | ç±»å‹   | å¿…å¡« | è¯´æ˜                                                                 |
| -------- | ------ | ---- | -------------------------------------------------------------------- |
| style    | string | å¦   | ç¿»è¯‘çš„é£æ ¼è¦æ±‚ï¼Œå¦‚"æ¯å¥å¼€å¤´åŠ ä¸Š`ğŸ˜­`ï¼Œåœ¨æ¯å¥ç¿»è¯‘ååŠ ä¸Š`ğŸ˜Š`"          |
| identity | string | å¦   | ç¿»è¯‘ä¸“å®¶çš„èº«ä»½ï¼Œå¯é€‰å€¼ï¼š"é€šç”¨ä¸“å®¶"ã€"å­¦æœ¯è®ºæ–‡ç¿»è¯‘å¸ˆ"ã€"æ„è¯‘ä½œå®¶"ã€"ç¨‹åºä¸“å®¶"ã€"å¤ä»Šä¸­å¤–ç¿»è¯‘å¸ˆ" |

#### è¯·æ±‚ä½“ç¤ºä¾‹

```json
{
  "word": [
    {
      "id": "word1",
      "word": "hello"
    },
    {
      "id": "word2",
      "word": "world"
    }
  ],
  "target": "ä¸­æ–‡",
  "extra_args": {
    "identity": "é€šç”¨ä¸“å®¶"
  }
}
```

#### å“åº”ç»“æœ

```json
{
  "translated_word": [
    {
      "id": "word1",
      "word": "ä½ å¥½"
    },
    {
      "id": "word2",
      "word": "ä¸–ç•Œ"
    }
  ]
}
```

### 5. æ–‡æœ¬è½¬è¯­éŸ³æ¥å£

#### æ¥å£è¯´æ˜

ç”¨äºå°†æ–‡æœ¬è½¬æ¢ä¸ºè¯­éŸ³ï¼ˆTTSï¼‰ï¼Œæ”¯æŒç”ŸæˆWAVæ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶

#### æ¥å£åœ°å€

```
POST /tts
```

#### è¯·æ±‚å‚æ•°

| å‚æ•°å     | ç±»å‹   | å¿…å¡« | è¯´æ˜                             |
| ---------- | ------ | ---- | -------------------------------- |
| full_text  | string | æ˜¯   | è¦è½¬æ¢ä¸ºè¯­éŸ³çš„å®Œæ•´æ–‡æœ¬           |
| extra_args | object | å¦   | é¢å¤–å‚æ•°ï¼Œå¦‚é£æ ¼ç­‰               |

#### extra_args å‚æ•°è¯´æ˜

| å‚æ•°å | ç±»å‹   | å¿…å¡« | è¯´æ˜ |
| ------ | ------ | ---- | ---- |
| style  | string | å¦   | è¯­éŸ³é£æ ¼è¦æ±‚ï¼ˆé¢„ç•™å‚æ•°ï¼‰ |

#### è¯·æ±‚ä½“ç¤ºä¾‹

```json
{
  "full_text": "ä½ å¥½ï¼Œä¸–ç•Œï¼",
  "extra_args": {
    "style": "æ­£å¼"
  }
}
```

#### å“åº”ç»“æœ

å“åº”ä¸ºWAVæ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶ï¼Œç›´æ¥ä»¥äºŒè¿›åˆ¶æµå½¢å¼è¿”å›ã€‚

å“åº”å¤´åŒ…å«ï¼š
- Content-Type: audio/wav
- Content-Disposition: é™„ä»¶å½¢å¼ï¼ŒåŒ…å«æ–‡ä»¶å

#### å“åº”ç¤ºä¾‹

è¿”å›ä¸€ä¸ªWAVæ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶ï¼Œå¯ç›´æ¥æ’­æ”¾æˆ–ä¸‹è½½ã€‚
